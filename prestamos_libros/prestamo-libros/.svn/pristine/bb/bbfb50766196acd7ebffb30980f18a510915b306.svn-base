<%@page import="java.text.SimpleDateFormat"%>
<%@page import="java.util.Date"%>
<%@page import="com.ipartek.formacion.prestamolibros.controller.CrudControllable"%>
<%@page import="com.ipartek.formacion.prestamolibros.pojo.Prestamo"%>
<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<%@include file="../includes/header.jsp"%>
<%@include file="../includes/nav.jsp"%>

<div id="page-wrapper">
	<%@include file="../includes/alert.jsp"%>

	<div class="row divTitulo">
        <div class="col-md-8">
            <h1 class="page-header titulo">Libros prestados <span class="badge">${fn:length(prestamos)}</span></h1>
        </div>
            
    
		<div class="col-md-4 btn-crear">
  			<a href="prestamos?id=-1&op=<%=CrudControllable.OP_IR_FORMULARIO%>" class="btn btn-primary">Prestar libro</a>  			
  		</div>
	</div>

	<table id="tablaOrdenable" class="display">
		<thead>
			<tr>
				<th>Finalizar préstamo</th>
				<th>Libro</th>
				<th>Alumno</th>
				<th>Fecha de inicio</th>
				<th>Fecha final</th>
				<th>Días restantes</th>
			</tr>
		</thead>
		<tbody>

			<c:forEach items="${prestamos}" var="p">

				<tr>
					<td><span onclick="showModalDevolucion()">Finalizar préstamo</span></td>
					<td><a href="libros?id=${p.libro.id}&op<%=CrudControllable.OP_IR_FORMULARIO %>" >${p.libro.titulo}</a></td>
					<td><a href="alumnos?id=${p.alumno.id}&op=<%=CrudControllable.OP_IR_FORMULARIO %>">${p.alumno.nombre}</a></td>
					<td>${p.fechaInicio}</td>
					<td>${p.fechaFin}</td>
					<td></td>
				</tr>

			</c:forEach>

		</tbody>
		<tfoot>
			<tr>
				<th>Finalizar préstamo</th>
				<th>Libro</th>
				<th>Alumno</th>
				<th>Fecha de inicio</th>
				<th>Fecha final</th>
				<th>Días restantes</th>
			</tr>
		</tfoot>
	</table>
	
	<!-- Modal devolución -->
			<div class="modal fade" id="modalEliminar" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
			  <div class="modal-dialog" role="document">
			    <div class="modal-content">
			      <div class="modal-header">
			        <h5 class="modal-title" id="exampleModalLabel">Atención</h5>
			        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
			          <span aria-hidden="true">&times;</span>
			        </button>
			      </div>
			      <div class="modal-body">
			      	<form action="prestamos" method="post">
			      		<label for="fechaDevolucion">Fecha de devolución</label>
			        	<input type="date" class="form-control" name="fechaDevolucion" id="fechaDevolucion" />
			        	<input type="hidden" name="op" value=<%=CrudControllable.OP_ELIMINAR %> />
			        	<input type="submit" class="btn btn-primary btn-block" value="Finalizar préstamo" />
			        </form>
			      </div>
			    </div>
			  </div>
			</div>


</div>
<%@include file="../includes/footer.jsp"%>